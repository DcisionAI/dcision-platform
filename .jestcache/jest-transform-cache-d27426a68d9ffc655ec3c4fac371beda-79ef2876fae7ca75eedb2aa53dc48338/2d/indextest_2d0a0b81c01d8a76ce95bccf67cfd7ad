6eaf36824dc0dd20bb6434ecafdb22ca
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
const generated_1 = require("./generated");
describe('SDK Client', () => {
    it('should create a DefaultApi client instance', () => {
        const apiKey = 'test-key';
        const baseUrl = 'http://localhost';
        const client = (0, index_1.createClient)(apiKey, baseUrl);
        expect(client).toBeInstanceOf(generated_1.DefaultApi);
    });
    describe('wrapper functions', () => {
        const apiKey = 'abc123';
        beforeEach(() => {
            // @ts-ignore
            global.fetch = jest.fn((url, opts) => Promise.resolve({
                ok: true,
                json: () => Promise.resolve({ success: true, url, body: opts === null || opts === void 0 ? void 0 : opts.body })
            }));
        });
        afterEach(() => {
            jest.resetAllMocks();
        });
        it('solveLaborScheduling sends correct payload', async () => {
            const model = { foo: 'bar' };
            const res = await (0, index_1.solveLaborScheduling)(apiKey, model, { baseUrl: 'http://host' });
            expect(res).toEqual(expect.objectContaining({ success: true }));
            // verify fetch called on correct endpoint and body contains model
            expect(global.fetch.mock.calls[0][0]).toBe('http://host/mcp/submit');
            const body = JSON.parse(global.fetch.mock.calls[0][1].body);
            expect(body.model).toMatchObject({ problemType: 'labor_scheduling', ...model });
        });
        it('solveResourceAllocation sends correct payload', async () => {
            const model = { a: 1 };
            const res = await (0, index_1.solveResourceAllocation)(apiKey, model);
            expect(res).toEqual(expect.objectContaining({ success: true }));
            const called = global.fetch.mock.calls[0];
            expect(called[0]).toBe('https://mcp.dcisionai.com/mcp/submit');
            const b = JSON.parse(called[1].body);
            expect(b.context.problemType).toBe('equipment_allocation');
            expect(b.model).toMatchObject({ problemType: 'equipment_allocation', ...model });
        });
        it('solveProjectScheduling sends correct payload', async () => {
            const model = { x: 42 };
            const res = await (0, index_1.solveProjectScheduling)(apiKey, model, { baseUrl: 'http://host' });
            expect(res).toEqual(expect.objectContaining({ success: true }));
            const called = global.fetch.mock.calls.pop();
            expect(called[0]).toBe('http://host/mcp/submit');
            const body = JSON.parse(called[1].body);
            expect(body.context.problemType).toBe('risk_simulation');
            expect(body.model).toMatchObject({ problemType: 'risk_simulation', ...model });
        });
        it('solveMaterialDeliveryPlanning sends correct payload', async () => {
            const model = { deliveries: [] };
            const res = await (0, index_1.solveMaterialDeliveryPlanning)(apiKey, model, { baseUrl: 'http://host' });
            expect(res).toEqual(expect.objectContaining({ success: true }));
            const called = global.fetch.mock.calls.pop();
            expect(called[0]).toBe('http://host/mcp/submit');
            const body = JSON.parse(called[1].body);
            expect(body.context.problemType).toBe('material_delivery_planning');
        });
        it('solveRiskSimulation sends correct payload', async () => {
            const model = { foo: 'bar' };
            const res = await (0, index_1.solveRiskSimulation)(apiKey, model, { baseUrl: 'http://host' });
            expect(res).toEqual(expect.objectContaining({ success: true }));
            const called = global.fetch.mock.calls.pop();
            expect(called[0]).toBe('http://host/mcp/submit');
            const body = JSON.parse(called[1].body);
            expect(body.context.problemType).toBe('risk_simulation');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2FtZXlkaGF2bGUvRG9jdW1lbnRzL0RjaXNpb25BSS9kY2lzaW9uYWktcGxhdGZvcm0vcGFja2FnZXMvc2RrLWpzL3NyYy9pbmRleC50ZXN0LnRzIiwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQWtLO0FBQ2xLLDJDQUF5QztBQUV6QyxRQUFRLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTtJQUMxQixFQUFFLENBQUMsNENBQTRDLEVBQUUsR0FBRyxFQUFFO1FBQ3BELE1BQU0sTUFBTSxHQUFHLFVBQVUsQ0FBQztRQUMxQixNQUFNLE9BQU8sR0FBRyxrQkFBa0IsQ0FBQztRQUNuQyxNQUFNLE1BQU0sR0FBRyxJQUFBLG9CQUFZLEVBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzdDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxjQUFjLENBQUMsc0JBQVUsQ0FBQyxDQUFDO0lBQzVDLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRTtRQUNqQyxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUM7UUFDeEIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNkLGFBQWE7WUFDYixNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FDbkMsT0FBTyxDQUFDLE9BQU8sQ0FBQztnQkFDZCxFQUFFLEVBQUUsSUFBSTtnQkFDUixJQUFJLEVBQUUsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsSUFBSSxFQUFFLENBQUM7YUFDdEUsQ0FBUSxDQUNWLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUNILFNBQVMsQ0FBQyxHQUFHLEVBQUU7WUFDYixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENB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QyxDQUFDO1FBQ3RFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3pELE1BQU0sS0FBSyxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxDQUFDO1lBQzdCLE1BQU0sR0FBRyxHQUFHLE1BQU0sSUFBQSwyQkFBbUIsRUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEVBQUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxDQUFDLENBQUM7WUFDakYsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ2hFLE1BQU0sTUFBTSxHQUFJLE1BQU0sQ0FBQyxLQUFtQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDNUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQzNELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvYW1leWRoYXZsZS9Eb2N1bWVudHMvRGNpc2lvbkFJL2RjaXNpb25haS1wbGF0Zm9ybS9wYWNrYWdlcy9zZGstanMvc3JjL2luZGV4LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50LCBzb2x2ZUxhYm9yU2NoZWR1bGluZywgc29sdmVSZXNvdXJjZUFsbG9jYXRpb24sIHNvbHZlUHJvamVjdFNjaGVkdWxpbmcsIHNvbHZlTWF0ZXJpYWxEZWxpdmVyeVBsYW5uaW5nLCBzb2x2ZVJpc2tTaW11bGF0aW9uIH0gZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQgeyBEZWZhdWx0QXBpIH0gZnJvbSAnLi9nZW5lcmF0ZWQnO1xuXG5kZXNjcmliZSgnU0RLIENsaWVudCcsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBEZWZhdWx0QXBpIGNsaWVudCBpbnN0YW5jZScsICgpID0+IHtcbiAgICBjb25zdCBhcGlLZXkgPSAndGVzdC1rZXknO1xuICAgIGNvbnN0IGJhc2VVcmwgPSAnaHR0cDovL2xvY2FsaG9zdCc7XG4gICAgY29uc3QgY2xpZW50ID0gY3JlYXRlQ2xpZW50KGFwaUtleSwgYmFzZVVybCk7XG4gICAgZXhwZWN0KGNsaWVudCkudG9CZUluc3RhbmNlT2YoRGVmYXVsdEFwaSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ3dyYXBwZXIgZnVuY3Rpb25zJywgKCkgPT4ge1xuICAgIGNvbnN0IGFwaUtleSA9ICdhYmMxMjMnO1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgZ2xvYmFsLmZldGNoID0gamVzdC5mbigodXJsLCBvcHRzKSA9PlxuICAgICAgICBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIGpzb246ICgpID0+IFByb21pc2UucmVzb2x2ZSh7IHN1Y2Nlc3M6IHRydWUsIHVybCwgYm9keTogb3B0cz8uYm9keSB9KVxuICAgICAgICB9KSBhcyBhbnlcbiAgICAgICk7XG4gICAgfSk7XG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgIGplc3QucmVzZXRBbGxNb2NrcygpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3NvbHZlTGFib3JTY2hlZHVsaW5nIHNlbmRzIGNvcnJlY3QgcGF5bG9hZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vZGVsID0geyBmb286ICdiYXInIH07XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBzb2x2ZUxhYm9yU2NoZWR1bGluZyhhcGlLZXksIG1vZGVsLCB7IGJhc2VVcmw6ICdodHRwOi8vaG9zdCcgfSk7XG4gICAgICBleHBlY3QocmVzKS50b0VxdWFsKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgc3VjY2VzczogdHJ1ZSB9KSk7XG4gICAgICAvLyB2ZXJpZnkgZmV0Y2ggY2FsbGVkIG9uIGNvcnJlY3QgZW5kcG9pbnQgYW5kIGJvZHkgY29udGFpbnMgbW9kZWxcbiAgICAgIGV4cGVjdCgoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9jay5jYWxsc1swXVswXSkudG9CZSgnaHR0cDovL2hvc3QvbWNwL3N1Ym1pdCcpO1xuICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UoKGdsb2JhbC5mZXRjaCBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHNbMF1bMV0uYm9keSk7XG4gICAgICBleHBlY3QoYm9keS5tb2RlbCkudG9NYXRjaE9iamVjdCh7IHByb2JsZW1UeXBlOiAnbGFib3Jfc2NoZWR1bGluZycsIC4uLm1vZGVsIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3NvbHZlUmVzb3VyY2VBbGxvY2F0aW9uIHNlbmRzIGNvcnJlY3QgcGF5bG9hZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG1vZGVsID0geyBhOiAxIH07XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBzb2x2ZVJlc291cmNlQWxsb2NhdGlvbihhcGlLZXksIG1vZGVsKTtcbiAgICAgIGV4cGVjdChyZXMpLnRvRXF1YWwoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBzdWNjZXNzOiB0cnVlIH0pKTtcbiAgICAgIGNvbnN0IGNhbGxlZCA9IChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzWzBdO1xuICAgICAgZXhwZWN0KGNhbGxlZFswXSkudG9CZSgnaHR0cHM6Ly9tY3AuZGNpc2lvbmFpLmNvbS9tY3Avc3VibWl0Jyk7XG4gICAgICBjb25zdCBiID0gSlNPTi5wYXJzZShjYWxsZWRbMV0uYm9keSk7XG4gICAgICBleHBlY3QoYi5jb250ZXh0LnByb2JsZW1UeXBlKS50b0JlKCdlcXVpcG1lbnRfYWxsb2NhdGlvbicpO1xuICAgICAgZXhwZWN0KGIubW9kZWwpLnRvTWF0Y2hPYmplY3QoeyBwcm9ibGVtVHlwZTogJ2VxdWlwbWVudF9hbGxvY2F0aW9uJywgLi4ubW9kZWwgfSk7XG4gICAgfSk7XG4gICAgXG4gICAgaXQoJ3NvbHZlUHJvamVjdFNjaGVkdWxpbmcgc2VuZHMgY29ycmVjdCBwYXlsb2FkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9kZWwgPSB7IHg6IDQyIH07XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBzb2x2ZVByb2plY3RTY2hlZHVsaW5nKGFwaUtleSwgbW9kZWwsIHsgYmFzZVVybDogJ2h0dHA6Ly9ob3N0JyB9KTtcbiAgICAgIGV4cGVjdChyZXMpLnRvRXF1YWwoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBzdWNjZXNzOiB0cnVlIH0pKTtcbiAgICAgIGNvbnN0IGNhbGxlZCA9IChnbG9iYWwuZmV0Y2ggYXMgamVzdC5Nb2NrKS5tb2NrLmNhbGxzLnBvcCgpO1xuICAgICAgZXhwZWN0KGNhbGxlZFswXSkudG9CZSgnaHR0cDovL2hvc3QvbWNwL3N1Ym1pdCcpO1xuICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UoY2FsbGVkWzFdLmJvZHkpO1xuICAgICAgZXhwZWN0KGJvZHkuY29udGV4dC5wcm9ibGVtVHlwZSkudG9CZSgncmlza19zaW11bGF0aW9uJyk7XG4gICAgICBleHBlY3QoYm9keS5tb2RlbCkudG9NYXRjaE9iamVjdCh7IHByb2JsZW1UeXBlOiAncmlza19zaW11bGF0aW9uJywgLi4ubW9kZWwgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc29sdmVNYXRlcmlhbERlbGl2ZXJ5UGxhbm5pbmcgc2VuZHMgY29ycmVjdCBwYXlsb2FkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9kZWwgPSB7IGRlbGl2ZXJpZXM6IFtdIH07XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBzb2x2ZU1hdGVyaWFsRGVsaXZlcnlQbGFubmluZyhhcGlLZXksIG1vZGVsLCB7IGJhc2VVcmw6ICdodHRwOi8vaG9zdCcgfSk7XG4gICAgICBleHBlY3QocmVzKS50b0VxdWFsKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgc3VjY2VzczogdHJ1ZSB9KSk7XG4gICAgICBjb25zdCBjYWxsZWQgPSAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9jay5jYWxscy5wb3AoKTtcbiAgICAgIGV4cGVjdChjYWxsZWRbMF0pLnRvQmUoJ2h0dHA6Ly9ob3N0L21jcC9zdWJtaXQnKTtcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKGNhbGxlZFsxXS5ib2R5KTtcbiAgICAgIGV4cGVjdChib2R5LmNvbnRleHQucHJvYmxlbVR5cGUpLnRvQmUoJ21hdGVyaWFsX2RlbGl2ZXJ5X3BsYW5uaW5nJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc29sdmVSaXNrU2ltdWxhdGlvbiBzZW5kcyBjb3JyZWN0IHBheWxvYWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtb2RlbCA9IHsgZm9vOiAnYmFyJyB9O1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgc29sdmVSaXNrU2ltdWxhdGlvbihhcGlLZXksIG1vZGVsLCB7IGJhc2VVcmw6ICdodHRwOi8vaG9zdCcgfSk7XG4gICAgICBleHBlY3QocmVzKS50b0VxdWFsKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgc3VjY2VzczogdHJ1ZSB9KSk7XG4gICAgICBjb25zdCBjYWxsZWQgPSAoZ2xvYmFsLmZldGNoIGFzIGplc3QuTW9jaykubW9jay5jYWxscy5wb3AoKTtcbiAgICAgIGV4cGVjdChjYWxsZWRbMF0pLnRvQmUoJ2h0dHA6Ly9ob3N0L21jcC9zdWJtaXQnKTtcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKGNhbGxlZFsxXS5ib2R5KTtcbiAgICAgIGV4cGVjdChib2R5LmNvbnRleHQucHJvYmxlbVR5cGUpLnRvQmUoJ3Jpc2tfc2ltdWxhdGlvbicpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==